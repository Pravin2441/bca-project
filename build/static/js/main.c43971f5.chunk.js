(this["webpackJsonpreact-slack-clone"]=this["webpackJsonpreact-slack-clone"]||[]).push([[0],{190:function(e,t,a){},267:function(e,t,a){},329:function(e,t,a){e.exports=a(533)},337:function(e,t,a){},506:function(e,t,a){},513:function(e,t,a){},527:function(e,t,a){},528:function(e,t,a){},532:function(e,t,a){},533:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(26),l=a.n(c),o=a(9),s=a(568),i=a(35),u=a(566),m=(a(337),a(19)),d=a.n(m),f=a(31),h=a(569),p=a(202),b=a(564),v=a(560),E=a(557),g=a(536),O=a(64),j=a(269),C=a(193),y=a.n(C);a(342),a(344),a(535),a(346);y.a.initializeApp({apiKey:"AIzaSyAdJKzmzN472Ux0tDwRw1as7sQGIArUkm4",authDomain:"messenger-9b12b.firebaseapp.com",databaseURL:"https://messenger-9b12b-default-rtdb.firebaseio.com",projectId:"messenger-9b12b",storageBucket:"messenger-9b12b.appspot.com",messagingSenderId:"870427118899",appId:"1:870427118899:web:2f6ec9bee0c862bb4e4246"});var S=y.a;function N(e){var t,a=e.currentUser,c=Object(n.useState)(a),l=Object(o.a)(c,1)[0],i=Object(n.useState)(!1),u=Object(o.a)(i,2),m=u[0],C=u[1],y=Object(n.useState)(""),N=Object(o.a)(y,2),w=N[0],k=N[1],_=Object(n.useState)(""),x=Object(o.a)(_,2),R=x[0],P=x[1],L=Object(n.useState)(""),D=Object(o.a)(L,2),T=D[0],U=D[1],A=Object(n.useState)(""),I=Object(o.a)(A,2),B=I[0],M=I[1],z=Object(n.useState)(!1),V=Object(o.a)(z,2),H=V[0],G=V[1],F=Object(n.useState)(S.storage().ref()),W=Object(o.a)(F,1)[0],Z=Object(n.useState)(S.auth().currentUser),J=Object(o.a)(Z,1)[0],K=Object(n.useState)(S.database().ref("users")),q=Object(o.a)(K,1)[0],Q={contentType:"image/jpeg"},X=function(){var e=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.auth().signOut();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){B&&Y(B)}),[B]);var Y=function(){var e=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J.updateProfile({photoURL:B});case 3:return e.next=5,q.child(l.uid).update({photoUrl:B});case 5:G(!1),C(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERRORS::::",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(s.a,null,r.a.createElement(s.a.Column,null,r.a.createElement(s.a.Row,{style:{padding:"1.2em",margin:0}},r.a.createElement(h.a,{inverted:!0,as:"h4",style:{padding:"1.2em"}},r.a.createElement(p.a,{style:{width:"3rem",height:"3rem"},avatar:!0,src:l.photoURL}),r.a.createElement(b.a,{trigger:r.a.createElement("span",{style:{fontSize:"1.5rem"},className:"menu-label"},l.displayName),options:[{key:"user",text:r.a.createElement("span",null,"Signed in as: ",r.a.createElement("strong",null,l.displayName)),disabled:!0},{key:"avatar",text:r.a.createElement("span",{onClick:function(){return C(!0)}},"Change Avatar")},{key:"signOut",text:r.a.createElement("span",{onClick:X},"Sign Out")}]})),r.a.createElement("input",{size:"mini",icon:"search",placeholder:"Search for user",className:"chatheader__searchbar-input"}))),r.a.createElement(v.a,{basic:!0,open:m},r.a.createElement(v.a.Header,null,"Change avatar"),r.a.createElement(v.a.Content,null,r.a.createElement(E.a,{fluid:!0,type:"file",label:"New Avatar",onChange:function(e){var t=e.target.files[0],a=new FileReader;t&&(a.readAsDataURL(t),a.addEventListener("load",(function(){k(a.result)})))}}),r.a.createElement(s.a,{centered:!0,stackable:!0,columns:"2"},r.a.createElement(s.a.Row,{centered:!0},r.a.createElement(s.a.Column,{className:"ui centered align grid"},w&&r.a.createElement(j.a,{ref:function(e){return t=e},image:w,height:220,width:300,scale:1.2})),r.a.createElement(s.a.Column,{className:"ui centered align grid"},R&&r.a.createElement(p.a,{style:{margin:"3.5rem auto"},width:300,height:200,src:R}))))),r.a.createElement(v.a.Actions,null,R&&r.a.createElement(g.a,{color:"green",inverted:!0,onClick:function(){G(!0),W.child("avatars/users/".concat(l.uid)).put(T,Q).then((function(e){e.ref.getDownloadURL().then(function(){var e=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:M(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))},disabled:H},r.a.createElement(O.a,{name:"checkmark"}),"Change Avatar"),r.a.createElement(g.a,{color:"purple",inverted:!0,onClick:function(){t&&t.getImageScaledToCanvas().toBlob((function(e){var t=URL.createObjectURL(e);P(t),U(e)}))}},r.a.createElement(O.a,{name:"image"}),"Preview"),r.a.createElement(g.a,{color:"red",inverted:!0,onClick:function(){C(!1),k("")}},r.a.createElement(O.a,{name:"remove"}),"Cancel"))))}var w=a(32),k=a(23),_=function(){var e=Object(n.useRef)(!0);return Object(n.useEffect)((function(){e.current=!1}),[]),e.current},x=function(e){return{type:"SET/CHANNEL",payload:e}},R=function(e){return{type:"SET/PRIVATE_CHANNEL",payload:{isChannelPrivate:e}}};function P(e){var t=e.currentUser,a=Object(n.useState)([]),c=Object(o.a)(a,2),l=c[0],s=c[1],m=Object(n.useState)(S.database().ref("users")),d=Object(o.a)(m,1)[0],f=Object(i.c)(),h=_();Object(n.useEffect)((function(){return h&&d.child(t.uid).child("starred").on("child_added",(function(e){var t=Object(k.a)({id:e.key},e.val());s((function(e){return[].concat(Object(w.a)(e),[t])}))})),function(){d.child("".concat(t.uid,"/starred")).off()}}),[]),Object(n.useEffect)((function(){return d.child(t.uid).child("starred").on("child_removed",(function(e){var t=Object(k.a)({id:e.key},e.val()),a=l.filter((function(e){return e.id!==t.id}));s(a)})),function(){d.child("".concat(t.uid,"/starred")).off()}}),[l]);var p,b=function(e){f(R(!1)),f(x(e))};return r.a.createElement("div",{style:{paddingBottom:"2rem"}},r.a.createElement("p",{className:"menu-label"},r.a.createElement("span",null,r.a.createElement(O.a,{name:"star"})," Channels")," ","(",l.length,")"),(p=l).length>0&&p.map((function(e){return r.a.createElement(u.a.Item,{key:e.id,onClick:function(){return b(e)},name:e.name,style:{opacity:.7}},"# ",e.name)})))}var L=a(43),D=a(290),T=a(291),U=a(314),A=a(313),I=a(116),B=a(561),M=function(e){Object(U.a)(a,e);var t=Object(A.a)(a);function a(){var e;Object(D.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={activeChannel:"",user:e.props.currentUser,channel:null,channels:[],channelName:"",channelDetails:"",channelsRef:S.database().ref("channels"),messagesRef:S.database().ref("messages"),typingRef:S.database().ref("typing"),notifications:[],modal:!1,firstLoad:!0},e.addListeners=function(){var t=[];e.state.channelsRef.on("child_added",(function(a){t.push(a.val()),e.setState({channels:t},(function(){return e.setFirstChannel()})),e.addNotificationListener(a.key)}))},e.addNotificationListener=function(t){e.state.messagesRef.child(t).on("value",(function(a){e.state.channel&&e.handleNotifications(t,e.state.channel.id,e.state.notifications,a)}))},e.handleNotifications=function(t,a,n,r){var c=0,l=n.findIndex((function(e){return e.id===t}));-1!==l?(t!==a&&(c=n[l].total,r.numChildren()-c>0&&(n[l].count=r.numChildren()-c)),n[l].lastKnownTotal=r.numChildren()):n.push({id:t,total:r.numChildren(),lastKnownTotal:r.numChildren(),count:0}),e.setState({notifications:n})},e.removeListeners=function(){e.state.channelsRef.off()},e.setFirstChannel=function(){var t=e.state.channels[0];e.state.firstLoad&&e.state.channels.length>0&&(e.props.setChannel(t),e.setActiveChannel(t),e.setState({channel:t})),e.setState({firstLoad:!1})},e.addChannel=function(){var t=e.state,a=t.channelsRef,n=t.channelName,r=t.channelDetails,c=t.user,l=a.push().key,o={id:l,name:n,details:r,createdBy:{name:c.displayName,avatar:c.photoURL}};a.child(l).update(o).then((function(){e.setState({channelName:"",channelDetails:""}),e.closeModal(),console.log("channel added")})).catch((function(e){console.error(e)}))},e.handleSubmit=function(t){t.preventDefault(),e.isFormValid(e.state)&&e.addChannel()},e.handleChange=function(t){e.setState(Object(L.a)({},t.target.name,t.target.value))},e.changeChannel=function(t){e.setActiveChannel(t),e.state.typingRef.child(e.state.channel.id).child(e.state.user.uid).remove(),e.clearNotifications(),e.props.setChannel(t),e.props.setPrivateChannel(!1),e.setState({channel:t})},e.clearNotifications=function(){var t=e.state.notifications.findIndex((function(t){return t.id===e.state.channel.id}));if(-1!==t){var a=Object(w.a)(e.state.notifications);a[t].total=e.state.notifications[t].lastKnownTotal,a[t].count=0,e.setState({notifications:a})}},e.setActiveChannel=function(t){e.setState({activeChannel:t.id})},e.getNotificationCount=function(t){var a=0;if(e.state.notifications.forEach((function(e){e.id===t.id&&(a=e.count)})),a>0)return a},e.displayChannels=function(t){return t.length>0&&t.map((function(t){return r.a.createElement("div",{className:"menu-item",key:t.id,onClick:function(){return e.changeChannel(t)},name:t.name,style:{opacity:.8},active:t.id===e.state.activeChannel},e.getNotificationCount(t)&&r.a.createElement(I.a,{className:"active__icon",color:"red"},e.getNotificationCount(t)),"# ",t.name)}))},e.isFormValid=function(e){var t=e.channelName,a=e.channelDetails;return t&&a},e.openModal=function(){return e.setState({modal:!0})},e.closeModal=function(){return e.setState({modal:!1})},e}return Object(T.a)(a,[{key:"componentDidMount",value:function(){this.addListeners()}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"render",value:function(){var e=this.state,t=e.channels,a=e.modal;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"menu"},r.a.createElement("p",{className:"menu-label"},r.a.createElement("span",null,r.a.createElement(O.a,{name:"exchange"})," Channels")," ","(",t.length,")"," ",r.a.createElement(O.a,{name:"add",style:{marginLeft:"3.1rem",cursor:"pointer"},onClick:this.openModal})),this.displayChannels(t)),r.a.createElement(v.a,{basic:!0,open:a,onClose:this.closeModal},r.a.createElement(v.a.Header,null,"Add a Channel"),r.a.createElement(v.a.Content,null,r.a.createElement(B.a,{onSubmit:this.handleSubmit},r.a.createElement(B.a.Field,null,r.a.createElement(E.a,{fluid:!0,label:"Name of Channel",name:"channelName",onChange:this.handleChange})),r.a.createElement(B.a.Field,null,r.a.createElement(E.a,{fluid:!0,label:"About the Channel",name:"channelDetails",onChange:this.handleChange})))),r.a.createElement(v.a.Actions,null,r.a.createElement(g.a,{color:"green",inverted:!0,onClick:this.handleSubmit},r.a.createElement(O.a,{name:"checkmark"})," Add"),r.a.createElement(g.a,{color:"red",inverted:!0,onClick:this.closeModal},r.a.createElement(O.a,{name:"remove"})," Cancel"))))}}]),a}(r.a.Component),z=Object(i.b)(null,{setChannel:x,setPrivateChannel:R})(M);var V=r.a.memo((function(e){var t=e.currentUser,a=Object(n.useState)([]),c=Object(o.a)(a,2),l=c[0],s=c[1],u=Object(n.useState)(S.database().ref("users")),m=Object(o.a)(u,1)[0],d=Object(n.useState)(S.database().ref(".info/connected")),f=Object(o.a)(d,1)[0],h=Object(n.useState)(S.database().ref("presence")),p=Object(o.a)(h,1)[0],b=Object(n.useState)(""),v=Object(o.a)(b,2),E=v[0],g=v[1],j=Object(i.c)();Object(n.useEffect)((function(){var e;return t&&(e=t.uid,m.on("child_added",(function(e){if(t.uid!==e.key){var a=e.val();a.uid=e.key,a.status="offline",s((function(e){return[].concat(Object(w.a)(e),[a])}))}})),f.on("value",(function(t){if(!0===t.val()){var a=p.child(e);a.set(!0),a.onDisconnect().remove((function(e){null!==e&&console.log(e)}))}}))),function(){m.off(),f.off()}}),[m,f]),Object(n.useEffect)((function(){var e=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];s((function(a){return a.map((function(a){return a.uid===e&&(a.status="".concat(t?"online":"offline")),a}))}))};return p.on("child_added",(function(a){t.uid!==a.key&&e(a.key)})),p.on("child_removed",(function(a){t.uid!==a.key&&e(a.key,!1)})),function(){p.off()}}),[]);var C=function(e){return"online"===e.status},y=function(e){var a=t.uid;return e<a?"".concat(e,"/").concat(a):"".concat(a,"/").concat(e)};return r.a.createElement("div",null,r.a.createElement("p",{className:"menu-label"},r.a.createElement("span",null,r.a.createElement(O.a,{name:"mail"})," Direct Messages")," ","(",l.length,")"),l.map((function(e,t){return r.a.createElement("div",{key:e.uid,active:E===e.uid,onClick:function(){return function(e){var t={id:y(e.uid),name:e.name};j(x(t)),j(R(!0)),g(e.uid)}(e)},className:"menu-item-label"},"@ ",e.name,r.a.createElement(O.a,{className:"active__icon",name:"circle",color:C(e)?"green":"red"}))})))}));function H(e){var t=e.currentUser;return r.a.createElement(u.a,{inverted:!0,size:"large",fixed:"left",vertical:!0,id:"menu"},r.a.createElement(N,{currentUser:t}),r.a.createElement(P,{currentUser:t}),r.a.createElement(z,{currentUser:t}),r.a.createElement(V,{currentUser:t}))}var G=a(562),F=(a(506),a(155)),W=a(44),Z=a(298),J=a.n(Z),K=a(294),q=a.n(K);function Q(e){var t=e.channelName,a=e.users,n=e.searchTerm,c=e.handleSearchMessages,l=e.searching,o=e.isChannelPrivate,s=e.handleStarChannel,i=e.isStarred,u=Object(F.a)(!0);return r.a.createElement("div",{className:"chat__main"},r.a.createElement("div",{className:"chatheader"},r.a.createElement("div",{className:"chatheader__topic"},r.a.createElement("h3",null,r.a.createElement("span",null,t,!o&&r.a.createElement(O.a,{style:{marginLeft:"5px"},onClick:s,name:i?"star":"star outline",color:i?"yellow":"black"})),r.a.createElement("span",{style:{marginLeft:"10px"}},a))),r.a.createElement("div",{className:"chatheader__items"},r.a.createElement("div",{className:"chatheader__items-left"},r.a.createElement(W.b,{to:"/video",target:"_blank",style:{marginTop:7,color:"silver"}},r.a.createElement(q.a,null)),r.a.createElement(J.a,{onClick:u.toggle})),r.a.createElement("div",{className:"chatheader__searchbar"},r.a.createElement("input",{size:"mini",icon:"search",placeholder:"Search",value:n,onChange:c,loading:l,className:"chatheader__searchbar-input"}),r.a.createElement("div",{className:"chatheader__searchbar-searchicon"},r.a.createElement("svg",{"aria-hidden":"false",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{fill:"currentColor",d:"M21.707 20.293L16.314 14.9C17.403 13.504 18 11.799 18 10C18 7.863 17.167 5.854 15.656 4.344C14.146 2.832 12.137 2 10 2C7.863 2 5.854 2.832 4.344 4.344C2.833 5.854 2 7.863 2 10C2 12.137 2.833 14.146 4.344 15.656C5.854 17.168 7.863 18 10 18C11.799 18 13.504 17.404 14.9 16.314L20.293 21.706L21.707 20.293ZM10 16C8.397 16 6.891 15.376 5.758 14.243C4.624 13.11 4 11.603 4 10C4 8.398 4.624 6.891 5.758 5.758C6.891 4.624 8.397 4 10 4C11.603 4 13.109 4.624 14.242 5.758C15.376 6.891 16 8.398 16 10C16 11.603 15.376 13.11 14.242 14.243C13.109 15.376 11.603 16 10 16Z"})))),r.a.createElement("div",{className:"chatheader__items-right"},r.a.createElement("svg",{x:"0",y:"0","aria-hidden":"false",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},r.a.createElement("path",{d:"M19 3H4.99C3.88 3 3.01 3.89 3.01 5L3 19C3 20.1 3.88 21 4.99 21H19C20.1 21 21 20.1 21 19V5C21 3.89 20.1 3 19 3ZM19 15H15C15 16.66 13.65 18 12 18C10.35 18 9 16.66 9 15H4.99V5H19V15Z",fill:"currentColor"})),r.a.createElement("svg",{x:"0",y:"0","aria-hidden":"false",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{fill:"currentColor",d:"M12 2C6.486 2 2 6.487 2 12C2 17.515 6.486 22 12 22C17.514 22 22 17.515 22 12C22 6.487 17.514 2 12 2ZM12 18.25C11.31 18.25 10.75 17.691 10.75 17C10.75 16.31 11.31 15.75 12 15.75C12.69 15.75 13.25 16.31 13.25 17C13.25 17.691 12.69 18.25 12 18.25ZM13 13.875V15H11V12H12C13.104 12 14 11.103 14 10C14 8.896 13.104 8 12 8C10.896 8 10 8.896 10 10H8C8 7.795 9.795 6 12 6C14.205 6 16 7.795 16 10C16 11.861 14.723 13.429 13 13.875Z"}))))))}var X=a(571),Y=a(200),$=a(312),ee=a(302),te=a.n(ee),ae=a(303),ne=a.n(ae),re=a(304),ce=a.n(re),le=a(198),oe=a.n(le);function se(e){var t=e.open,a=e.closeModal,n=e.uploadFile,c=r.a.useState(null),l=Object(o.a)(c,2),s=l[0],i=l[1],u=function(e){return["image/jpeg","image/png"].includes(oe.a.lookup(e))},m=function(){return i(null)};return r.a.createElement(v.a,{open:t,onClose:a},r.a.createElement(v.a.Header,null,"Select a file"),r.a.createElement(v.a.Content,null,r.a.createElement(E.a,{fluid:!0,type:"file",label:"Upload File(jpeg, png)",onChange:function(e){var t=e.target.files[0];null!==t&&i(t)}})),r.a.createElement(v.a.Actions,null,r.a.createElement(g.a,{onClick:function(){if(u(s.name)){var e={contentType:oe.a.contentType(s.name)};n(s,e),m(),a()}},color:"green"},r.a.createElement(O.a,{name:"cloud upload"})," Upload"),r.a.createElement(g.a,{onClick:function(){i(""),a()},color:"red"},r.a.createElement(O.a,{name:"remove"}),"Cancel")))}var ie=a(558);function ue(e){var t=e.uploadPercent;return"UPLOADING"===e.uploadState&&r.a.createElement(ie.a,{inverted:!0,className:"progress__bar",percent:t,progress:!0,indicating:!0,size:"medium"})}a(513),a(514);var me=a(567);function de(e){var t=e.currentChannel,a=e.currentUser,c=e.messagesRef,l=e.isChannelPrivate,s=Object(n.useState)(""),i=Object(o.a)(s,2),u=i[0],m=i[1],h=Object(n.useState)("IDLE"),p=Object(o.a)(h,2)[1],b=Object(n.useState)([]),v=Object(o.a)(b,2)[1],E=Object(n.useState)(!1),g=Object(o.a)(E,2),O=g[0],j=g[1],C=Object(n.useState)(S.storage().ref()),y=Object(o.a)(C,1)[0],N=Object(n.useState)(S.database().ref("typing")),k=Object(o.a)(N,1)[0],_=Object(n.useState)(null),x=Object(o.a)(_,2),R=x[0],P=x[1],L=Object(n.useState)(0),D=Object(o.a)(L,2),T=D[0],U=D[1],A=Object(n.useState)(""),I=Object(o.a)(A,2),B=I[0],M=I[1],z=Object(n.useState)(""),V=Object(o.a)(z,2),H=V[0],G=V[1],F=Object(n.useState)(!1),W=Object(o.a)(F,2),Z=W[0],J=W[1],K=Object(n.useState)(!1),q=Object(o.a)(K,2),Q=q[0],ee=q[1],ae=Object(n.useState)(""),re=Object(o.a)(ae,2)[1],le=Object(n.useRef)(null);Object(n.useEffect)((function(){return null!==R&&R.on("state_changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);U(t)}),(function(e){M("ERROR"),v((function(t){return[].concat(Object(w.a)(t),[e.message])}))}),(function(){R.snapshot.ref.getDownloadURL().then((function(e){oe(e,H)})).catch((function(e){M("ERROR"),v((function(t){return[].concat(Object(w.a)(t),[e.message])}))}))})),function(){null!==R&&(R.cancel(),P(null))}}),[R]);var oe=function(e,t){c().child(t).push().set(ie(e)).then((function(){M("DONE")})).catch((function(e){v((function(t){return[].concat(Object(w.a)(t),[e])}))}))},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={timestamp:S.database.ServerValue.TIMESTAMP,user:{id:a.uid,name:a.displayName,avatar:a.photoURL}};return null!==e?t.image=e:t.content=u,t},de=function(){var e=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=18;break}return p("PENDING"),e.prev=2,e.next=5,c().child(t.id).push().set(ie());case 5:return e.next=7,k.child(t.id).child(a.uid).remove();case 7:m(""),v((function(e){return[]})),p("RESOLVED"),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),console.log("Error while sending message: ",e.t0),p("REJECTED"),v((function(t){return[].concat(Object(w.a)(t),[{message:e.t0.message}])}));case 16:e.next=19;break;case 18:v((function(e){return[].concat(Object(w.a)(e),[{message:"Add a message.."}])}));case 19:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),fe=function(e){return e.replace(/:[A-Za-z0-9_+-]+:/g,(function(e){e=e.replace(/:/g,"");var t=Y.b.emojis[e];if("undefined"!==typeof t){var a=t.native;if("undefined"!==typeof a)return a}return e=":"+e+":"}))},he=t.name.toLowerCase();return r.a.createElement("div",{className:"message__form"},Q&&r.a.createElement($.a,{apiKey:"m8zn7XPBBGgyFC0QlJdTZCrG9y9ofAj1",onSelect:function(e){console.log(e);var t=e.images.downsized_medium.url;re(t);var a="".concat(t,".jpg");ie(a),console.log(a),console.log(e.images.downsized_medium);var n=new Blob([a],{type:"image/jpeg"}),r=y.child(a).put(n);P(r),m(a),ee(!1),setTimeout((function(){le.current.focus()}),0)}}),Z&&r.a.createElement(Y.a,{set:"apple",className:"emojiPicker",title:"Pick an emoji",emoji:"point_up",onSelect:function(e){console.log(e);var t=fe(" ".concat(u," ").concat(e.colons," "));m(t),ee(!1),J(!1),setTimeout((function(){le.current.focus()}),0)}}),r.a.createElement("div",{className:"chatsearchbar"},r.a.createElement("div",{className:"chatsearchbar__addicon"},r.a.createElement(me.a,{onClick:function(){return j(!0)},className:"icon__button","aria-label":"settings"},r.a.createElement(te.a,{className:"icon__button",style:{fontSize:25}}))),r.a.createElement("div",{className:"chatsearchbar__input"},r.a.createElement("input",{autoFocus:!0,placeholder:"Message #".concat(he),value:u,onChange:function(e){return m(e.target.value)},ref:le,onKeyPress:function(e){13===e.charCode&&de(),u?k.child(t.id).child(a.uid).set(a.displayName):k.child(t.id).child(a.uid).remove()}})),r.a.createElement("div",{className:"chatsearchbar__gifcon"},r.a.createElement(me.a,{onClick:function(){ee(!Q)},className:"icon__button","aria-label":"settings"},r.a.createElement(ne.a,{className:"icon__button",style:{fontSize:30}}))),r.a.createElement("div",{className:"chatsearchbar__emojiicon"},r.a.createElement(me.a,{icon:Z?"close":"smile outline",content:Z?"close":null,onClick:function(){J(!Z)}},r.a.createElement(ce.a,{className:"icon__button",style:{fontSize:30}})))),r.a.createElement(se,{open:O,closeModal:function(){return j(!1)},uploadFile:function(e,a){console.log(e),G(t.id);var n,r="".concat((n=t.id,l?"chat/private/".concat(n):"chat/public"),"/").concat(Object(X.a)(),".jpg");M("UPLOADING");var c=y.child(r).put(e,a);P(c),console.log(c)}}),r.a.createElement(ue,{uploadPercent:T,uploadState:B}))}var fe=a(305),he=a.n(fe),pe=(a(267),a(575)),be=a(306),ve=a.n(be),Ee=function(e,t){return e.user.id===t.uid?"message__self":""};function ge(e){var t,a=e.message,n=e.user;return r.a.createElement("div",{className:"message"},r.a.createElement(ve.a,null,r.a.createElement(pe.a,{src:a.user.avatar}),r.a.createElement("div",{className:Ee(a,n)},r.a.createElement("div",{className:"message__info"},r.a.createElement("h4",null,a.user.name,r.a.createElement("span",{className:"message__timestamp"},(t=a.timestamp,he()(t).fromNow()))),function(e){return e.hasOwnProperty("image")&&!e.hasOwnProperty("content")}(a)?r.a.createElement(p.a,{src:a.image,style:{padding:" 0.7em 0"}}):r.a.createElement("p",{className:"content"},a.content)))))}var Oe=function(){return r.a.createElement("div",{className:"typing"},r.a.createElement("div",{className:"typing__dot"}),r.a.createElement("div",{className:"typing__dot"}),r.a.createElement("div",{className:"typing__dot"}))};function je(){return r.a.createElement("div",{className:"skeleton"},r.a.createElement("div",{className:"skeleton__avatar"}),r.a.createElement("div",{className:"skeleton__author"}),r.a.createElement("div",{className:"skeleton__details"}))}function Ce(e){var t=e.currentUser,a=e.currentChannel,c=_(),l=Object(n.useState)(t),s=Object(o.a)(l,1)[0],u=Object(n.useState)(a),m=Object(o.a)(u,1)[0],d=Object(n.useState)([]),f=Object(o.a)(d,2),h=f[0],p=f[1],b=Object(n.useState)(!0),v=Object(o.a)(b,2),E=v[0],g=v[1],O=Object(n.useState)(""),j=Object(o.a)(O,2),C=j[0],y=j[1],N=Object(n.useState)(!1),k=Object(o.a)(N,2),x=k[0],R=k[1],P=Object(n.useState)([]),D=Object(o.a)(P,2),T=D[0],U=D[1],A=Object(n.useState)([]),I=Object(o.a)(A,2),B=I[0],M=I[1],z=Object(n.useState)(!0),V=Object(o.a)(z,2),H=V[0],F=V[1],W=Object(n.useState)(S.database().ref("messages")),Z=Object(o.a)(W,1)[0],J=Object(n.useState)(S.database().ref("privateMessages")),K=Object(o.a)(J,1)[0],q=Object(n.useState)(S.database().ref("users")),X=Object(o.a)(q,1)[0],Y=Object(n.useState)(S.database().ref("typing")),$=Object(o.a)(Y,1)[0],ee=Object(n.useState)(S.database().ref(".info/connected")),te=Object(o.a)(ee,1)[0],ae=Object(n.useState)([]),ne=Object(o.a)(ae,2),re=ne[0],ce=ne[1],le=Object(i.c)(),oe=Object(i.d)((function(e){return e.channel.private})),se=Object(n.useRef)(null);Object(n.useEffect)((function(){return s&&m&&(ie(m),fe(m.id,s.uid)),function(){return pe()}}),[]);var ie=function(e){me(e.id),he(e.id)},ue=function(e,t,a){if(-1===re.findIndex((function(n){return n.id===e&&n.ref===t&&n.event===a}))){var n={id:e,ref:t,event:a};ce((function(e){return[].concat(Object(w.a)(e),[n])}))}},me=function(e){be().child(e).on("child_added",(function(e){var t=e.val();g(!1),p((function(e){return[].concat(Object(w.a)(e),[t])}))})),ue(e,be(),"child_added")},fe=function(e,t){X.child(t).child("starred").once("value").then((function(t){if(null!==t.val()){var a=Object.keys(t.val()).includes(e);F(a)}}))};Object(n.useEffect)((function(){c||(H?X.child("".concat(s.uid,"/starred")).update(Object(L.a)({},m.id,{name:m.name,description:m.description,createdBy:{name:m.createdBy.name,avatar:m.createdBy.avatar}})):X.child("".concat(s.uid,"/starred/").concat(m.id)).remove((function(e){null!==e&&console.error("ERROR: ",e)})))}),[H]);var he=function(e){var n=[];$.child(e).on("child_added",(function(e){e.key!==t.id&&(n.concat({id:e.key,name:e.val()}),M(n))})),ue(e,$,"child_added"),$.child(e).on("child_removed",(function(e){-1!==n.findIndex((function(t){return t.id===e.key}))&&(n=n.filter((function(t){return t.id!==e.key})),M(n))})),ue(e,$,"child_removed"),te.on("value",(function(e){!0===e.val&&$.child(a.id).child(t.uid).onDisconnect().remove((function(e){null!==e&&console.log(e)}))}))},pe=function(){re.forEach((function(e){e.ref.child(e.id).off(e.event)}))},be=function(){return oe?K:Z};Object(n.useEffect)((function(){var e=new RegExp(C,"gi"),t=h.reduce((function(t,a){return(a.content&&a.content.match(e)||a.user.name.match(e))&&t.push(a),t}),[]);U(t),setTimeout((function(){return R(!1)}),800)}),[C]);var ve=function(e){return e.length>0&&e.map((function(e){return r.a.createElement(ge,{key:e.timestamp,message:e,user:s})}))};Object(n.useEffect)((function(){!function(){var e=h.reduce((function(e,t){return t.user.name in e?e[t.user.name].count+=1:e[t.user.name]={avatar:t.user.avatar,count:1},e}),{});le(function(e){return{type:"SET/USER_POSTS",payload:e}}(e))}(),se&&se.current.scrollIntoView({behavior:"smooth"})}),[h]);var Ee;return r.a.createElement("div",{className:oe?"chatPrivate":"chat"},r.a.createElement("div",null,r.a.createElement(Q,{channelName:function(e){return e&&"".concat(oe?"@":"#"," ").concat(e.name)}(m),users:function(e){var t=e.reduce((function(e,t){return e.includes(t.user.name)||e.push(t.user.name),e}),[]).length,a=t>1||0===t;return"".concat(t," user").concat(a&&"s")}(h),searchTerm:C,handleSearchMessages:function(e){y(e.target.value),R(!0)},searching:x,isChannelPrivate:oe,handleStarChannel:function(){F(!H)},isStarred:H}),r.a.createElement("div",{className:"messages"},r.a.createElement(G.a.Group,null,E?Object(w.a)(Array(10)).map((function(e,t){return r.a.createElement(je,{key:t})})):null,ve(C?T:h),r.a.createElement("div",{ref:se})),(Ee=B).length>0&&Ee.map((function(e){return r.a.createElement("div",{key:e.id,style:{display:"flex",alignItems:"center",marginBottom:"0.3em"}},r.a.createElement("span",{className:"user__typing"},e.name," is typing..."),r.a.createElement(Oe,null))}))),r.a.createElement(de,{currentChannel:a,currentUser:t,messagesRef:be,isChannelPrivate:oe})))}var ye=a(199),Se=a(574);a(527);function Ne(e){var t=e.isPrivateChannel,a=e.currentChannel,n=e.userPosts,c=function(e){return"".concat(e,e>1||0===e?" posts":" post")};return t?null:r.a.createElement("div",{className:"metapanel",loading:!a},r.a.createElement("div",{className:"metapanel__content"},r.a.createElement("h3",null,"About # ",a&&a.name),r.a.createElement("div",null,r.a.createElement("p",null,a&&a.description),r.a.createElement("h4",null,r.a.createElement(O.a,{name:"user circle"}),"Top posters"),r.a.createElement("p",null,r.a.createElement(Se.a,null,n&&Object.entries(n).sort((function(e,t){return t[1]-e[1]})).map((function(e,t){var a=Object(o.a)(e,2),n=a[0],l=a[1];return r.a.createElement(ye.a,{className:"metalist",key:n},r.a.createElement(p.a,{style:{height:"2.5rem",width:"2.5rem"},avatar:!0,src:l.avatar}),r.a.createElement(Se.a.Content,{className:"metalist__content"},r.a.createElement(Se.a.Header,{as:"a",style:{fontSize:"1.2rem"}},n),r.a.createElement("span",{style:{fontSize:"1rem"}},c(l.count))))})))),r.a.createElement("div",{className:"meta__createdBy"},r.a.createElement("h4",null,r.a.createElement(O.a,{name:"pencil alternate"}),"Created By"),r.a.createElement("h4",null,r.a.createElement("img",{className:"img",src:a&&a.createdBy.avatar,alt:"currentChannel"}),r.a.createElement("p",null,a&&a.createdBy.name))))))}a(528);var we,ke=a(307),_e=a(159),xe={sidebar:"#f2f3f5",scrollbarPath:"#f2f2f2",channelList:"#747f8d",topSearchBar:"#e3e5e8",icons:"#4f5660",icons_hover:"#9facbf",messageSearchbar:"#ebedef",chatHover:"#d4d7dc",chatBackground:"#fff",text:"#181818",opacity:.9},Re={sidebar:"#2f3136",scrollbarPath:"#2e3338",channelList:"#f9ffff",topSearchBar:"#202225",icons:"#b9bbbe",messageSearchbar:"#40444b",chatHover:"#393c43",icons_hover:"#d3d6db",chatBackground:"#36393f",text:"#f2f2f2",opacity:1},Pe=Object(_e.b)(we||(we=Object(ke.a)(["\n    body{\n        background: ",";\n        color: ",";\n        height: 100vh;\n        box-sizing: border-box;\n        margin: 0;\n        padding: 0;\n        transition: all 0.50s linear;\n        overflow: hidden;\n    }\n    .app{\n        transition: all 0.50s linear;\n    }\n    .chatheader{\n        background-color: ",";\n        color: ",";\n        transition: all 0.50s linear;\n\n       \n    }\n    .chatheader__searchbar-input{\n            color:",";\n            background-color: ",";\n            transition: all 0.50s linear;\n\n\n    }\n    .chatheader__items{\n        color:",";\n        transition: all 0.50s linear;\n\n    }\n\n    .metapanel{\n        background-color: ",";\n        color:  ",";\n        transition: all 0.50s linear;\n\n    }\n\n    .message{\n        background-color: ",";\n        color: ",";\n\n        transition: all 0.5s linear;\n        \n\n        &:hover{\n            background-color: ",";\n            position: sticky;\n            /* width: 60vw; */\n        }\n    }\n    .messages{\n        background-color: ",";\n        color: ",";\n        transition: all 0.50s linear;\n\n    }\n\n    .content{\n        opacity: ",";\n        transition: all 0.50s linear;\n\n    }\n    \n    .message__timestamp{\n        color: ",";\n        transition: all 0.50s linear;\n\n    }\n\n    .chatsearchbar{\n        background-color: ",";\n        color: ",";\n        transition: all 0.50s linear;\n        input{\n            background-color: ",";\n            color: ",";\n            transition: all 0.50s linear;\n        }\n    }\n\n    .icon__button{\n        color: ",";\n        transition: all 0.50s linear;\n\n        /* font-size: 30px; */\n    }\n    .icon__button:hover{\n        color: ",";\n        \n    }\n\n    #menu{\n        color: ",";\n        background-color: ",";\n        transition: all 0.50s linear;\n    }\n    .menu-label{\n        color: ",";\n        transition: all 0.50s linear;\n\n    }\n\n    .menu-item{\n        color: ",";\n        opacity: ",";\n        transition: all 0.50s linear;\n\n\n        &:hover{\n            background-color: ",";\n        }\n    }\n\n    .menu-item-label{\n        &:hover{\n            background-color: ",";\n            /* transition: all 0.50s linear; */\n\n        }\n    }\n\n    \n\n    \n\n"])),(function(e){return e.theme.chatBackground}),(function(e){return e.theme.text}),(function(e){return e.theme.chatBackground}),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.topSearchBar}),(function(e){return e.theme.icons}),(function(e){return e.theme.sidebar}),(function(e){return e.theme.text}),(function(e){return e.theme.chatBackground}),(function(e){return e.theme.text}),(function(e){return e.theme.chatHover}),(function(e){return e.theme.chatBackground}),(function(e){return e.theme.text}),(function(e){return e.theme.opacity}),(function(e){return e.theme.text}),(function(e){return e.theme.messageSearchbar}),(function(e){return e.theme.text}),(function(e){return e.theme.messageSearchbar}),(function(e){return e.theme.text}),(function(e){return e.theme.icons}),(function(e){return e.theme.icons_hover}),(function(e){return e.theme.text}),(function(e){return e.theme.sidebar}),(function(e){return e.theme.text}),(function(e){return e.theme.text}),(function(e){return e.theme.opacity}),(function(e){return e.theme.chatHover}),(function(e){return e.theme.chatHover}));function Le(){var e=Object(F.a)(!0),t=r.a.useState(!1),a=Object(o.a)(t,2),n=a[0],c=a[1],l=e.value?Re:xe,u=Object(i.d)((function(e){var t=e.user,a=e.channel;return{currentUser:t.currentUser,currentChannel:a.currentChannel,isPrivateChannel:a.private,userPosts:a.userPosts}})),m=u.currentUser,d=u.currentChannel,f=u.isPrivateChannel,h=u.userPosts;return r.a.useEffect((function(){c(!0)}),[]),r.a.createElement(_e.a,{theme:l},r.a.createElement(Pe,null),n&&r.a.createElement(s.a,{columns:"equal",className:"app"},r.a.createElement(H,{key:m&&m.id,currentUser:m}),r.a.createElement(s.a.Column,{style:{marginLeft:268}},m&&d&&r.a.createElement(Ce,{key:d&&d.id,currentChannel:d,currentUser:m})),!f&&r.a.createElement(s.a.Column,{width:2},r.a.createElement(Ne,{isPrivateChannel:f,currentChannel:d,userPosts:h}))))}var De=a(572),Te=a(565),Ue=(a(190),a(24));function Ae(){var e={email:"",password:""},t=Object(Ue.f)(),a=r.a.useState(e),n=Object(o.a)(a,2),c=n[0],l=n[1],s=r.a.useState([]),i=Object(o.a)(s,2),u=i[0],m=i[1],h=r.a.useState(""),p=Object(o.a)(h,2),b=p[0],v=p[1],E=function(e){l(Object(k.a)(Object(k.a)({},c),{},Object(L.a)({},e.target.name,e.target.value)))},g=function(){var a=Object(f.a)(d.a.mark((function a(n){var r,o,s,i;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),r=[],!j(c)){a.next=19;break}return o=c.email,s=c.password,m(r),v("PENDING"),a.prev=6,a.next=9,S.auth().signInWithEmailAndPassword(o,s);case 9:v("RESOLVED"),t.push("/"),a.next=17;break;case 13:a.prev=13,a.t0=a.catch(6),v("RESOLVED"),m(r.concat({message:a.t0.message}));case 17:a.next=21;break;case 19:i={message:"Please fill the form"},m(r.concat(i));case 21:l(e);case 22:case"end":return a.stop()}}),a,null,[[6,13]])})));return function(e){return a.apply(this,arguments)}}(),j=function(e){var t=e.email,a=e.password;return t&&a},C=function(e,t){return e.some((function(e){return e.message.toLowerCase().includes(t.toLowerCase())}))?"error":""},y=c.email,N=c.password;return r.a.createElement(De.a,null,r.a.createElement(Te.a,{timeout:500,classNames:"alert"},r.a.createElement("div",{className:"auth"},r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"login",style:{marginTop:-70}},r.a.createElement("h2",null,r.a.createElement(O.a,{name:"fork"}),"Welcome back!"),r.a.createElement("h3",null,"We're so excited to see you again!"),r.a.createElement("form",{size:"large",onSubmit:g},r.a.createElement("label",{style:{color:u.includes("email")?"#d72323":"white"}},"EMAIL"),r.a.createElement("input",{type:"email",name:"email",placeholder:"Email",value:y,onChange:E,className:C(u,"email")}),r.a.createElement("label",{style:{color:u.includes("password")?"#d72323":"white"}},"PASSWORD"),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",value:N,onChange:E,className:C(u,"password")}),r.a.createElement("button",{disabled:"PENDING"===b,className:"PENDING"===b?"loading":"",type:"submit",color:"purple",size:"large"},"Login")),r.a.createElement("h4",null,r.a.createElement(W.b,{to:"/forget-password"},"Forget Password? ")),u.length>0&&u.map((function(e,t){return r.a.createElement("div",{className:"error",key:t},r.a.createElement("p",null,e.message))})),r.a.createElement("h4",null,r.a.createElement(W.b,{to:"/register",style:{fontSize:"1.2rem"}},"Register")))))))}var Ie=a(310),Be=a.n(Ie);function Me(){var e={userName:"",email:"",password:"",confirmPassword:""},t=r.a.useState(e),a=Object(o.a)(t,2),n=a[0],c=a[1],l=r.a.useState([]),s=Object(o.a)(l,2),i=s[0],u=s[1],m=r.a.useState(""),h=Object(o.a)(m,2),p=h[0],b=h[1],v=r.a.useState(""),E=Object(o.a)(v,1)[0],g=r.a.useState(S.database().ref("/users")),j=Object(o.a)(g,1)[0],C=Object(Ue.f)(),y=function(e){c(Object(k.a)(Object(k.a)({},n),{},Object(L.a)({},e.target.name,e.target.value)))},N=function(){var e,t=[];return w(n)?(e={message:"Please fill in all the fields"},u(t.concat(e)),!1):!!_(n)||(e={message:"Password is invalid"},u(t.concat(e)),!1)},w=function(e){var t=e.userName,a=e.email,n=e.password,r=e.confirmPassword;return!t||!a||!n||!r},_=function(e){var t=e.password,a=e.confirmPassword;return!(t.length<6||a.length<6)&&t===a},x=function(){var t=Object(f.a)(d.a.mark((function t(a){var r,l,o,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),!N()){t.next=29;break}return r=n.email,l=n.password,u(o=[]),b("PENDING"),t.prev=6,t.next=9,S.auth().createUserWithEmailAndPassword(r,l);case 9:return s=t.sent,t.prev=10,t.next=13,s.user.updateProfile({displayName:D,photoURL:"https://www.gravatar.com/avatar/".concat(Be()(s.user.email),"?d=identicon")});case 13:return t.next=15,R(s);case 15:b("RESOLVED"),C.push("/login"),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(10),b("RESOLVED"),u(o.concat({message:t.t0.message}));case 23:t.next=29;break;case 25:t.prev=25,t.t1=t.catch(6),b("RESOLVED"),u(o.concat({message:t.t1.message}));case 29:c(e);case 30:case"end":return t.stop()}}),t,null,[[6,25],[10,19]])})));return function(e){return t.apply(this,arguments)}}(),R=function(e){return j.child(e.user.uid).set({name:e.user.displayName,photoUrl:e.user.photoURL})},P=function(e,t){return e.some((function(e){return e.message.toLowerCase().includes(t.toLowerCase())}))?"error":""},D=n.userName,T=n.email,U=n.password,A=n.confirmPassword;return r.a.createElement("div",{className:"auth"},r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"register",style:{marginTop:"-140px"}},r.a.createElement("h2",null,r.a.createElement(O.a,{name:"puzzle piece"}),"Register for new account"),r.a.createElement("form",{onSubmit:x},r.a.createElement("label",{style:{color:i.includes("username")?"#d72323":"white"}},"USERNAME"),r.a.createElement("input",{type:"text",name:"userName",icon:"user",placeholder:"User Name",value:D,onChange:y,className:P(i,"userName")}),r.a.createElement("label",{style:{color:i.includes("email")?"#d72323":"white"}},"EMAIL"),r.a.createElement("input",{type:"email",name:"email",placeholder:"Email",value:T,onChange:y,className:P(i,"email")}),r.a.createElement("label",{style:{color:i.includes("password")?"#d72323":"white"}},"PASSWORD"),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",value:U,onChange:y,className:P(i,"password")}),r.a.createElement("label",{style:{color:i.includes("password")?"#d72323":"white"}},"CONFIRM PASSWORD"),r.a.createElement("input",{type:"password",name:"confirmPassword",placeholder:"Confirm Password",value:A,onChange:y,className:P(i,"password")}),r.a.createElement("button",{disabled:"PENDING"===p,className:"PENDING"===p?"loading":"",type:"submit"},"Register")),E&&r.a.createElement("p",{className:"error"},E),i.length>0&&i.map((function(e,t){return r.a.createElement("div",{className:"error",key:t},r.a.createElement("p",null,e.message))})),r.a.createElement("div",null,r.a.createElement(W.b,{to:"/login",style:{fontSize:"1.2rem"}},"Already have an account? Login!")))))}var ze=a(570),Ve=a(559);function He(){return r.a.createElement(ze.a,{active:!0},r.a.createElement(Ve.a,{size:"huge",content:"Preparing chat..."}))}var Ge,Fe,We,Ze=a(112),Je=a(311),Ke={isLoading:!0,currentUser:null},qe={currentChannel:null,private:!1,userPosts:null},Qe=Object(Ze.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ke,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"SET/USER":return{isLoading:!1,currentUser:n};case"CLEAR/USER":return Object(k.a)(Object(k.a)({},Ke),{},{isLoading:!1});default:return e}},channel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"SET/CHANNEL":return Object(k.a)(Object(k.a)({},e),{},{currentChannel:n});case"SET/PRIVATE_CHANNEL":return Object(k.a)(Object(k.a)({},e),{},{private:n.isChannelPrivate});case"SET/USER_POSTS":return Object(k.a)(Object(k.a)({},e),{},{userPosts:n});default:return e}}}),Xe=Object(Ze.createStore)(Qe,Object(Je.composeWithDevTools)()),Ye=(a(531),a(532),S.firestore()),$e={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10};var et=function(){var e=Object(n.createRef)(),t=Object(n.createRef)(),a=Object(n.useState)(!1),c=Object(o.a)(a,2),l=c[0],s=c[1],i=Object(n.useState)(!0),u=Object(o.a)(i,2),m=u[0],h=u[1],p=Object(n.useState)(!0),b=Object(o.a)(p,2),v=b[0],O=b[1],j=Object(n.useState)(!0),C=Object(o.a)(j,2),y=C[0],S=C[1],N=Object(n.useState)(""),w=Object(o.a)(N,2),k=w[0],_=w[1],x=function(){var a=Object(f.a)(d.a.mark((function a(){return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,new RTCPeerConnection($e);case 2:return Ge=a.sent,a.next=5,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 5:Fe=a.sent,We=new MediaStream,Fe.getTracks().forEach((function(e){Ge.addTrack(e,Fe)})),Ge.ontrack=function(e){e.streams[0].getTracks().forEach((function(e){We.addTrack(e)}))},console.log(Fe),console.log(We),e.current.srcObject=Fe,t.current.srcObject=We,e.current.muted=!0,s(!0),h(!1),O(!1);case 17:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),R=function(){var e=Object(f.a)(d.a.mark((function e(){var t,a,n,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ye.collection("calls").doc(),console.log(t.id),a=t.collection("offerCandidates"),n=t.collection("answerCandidates"),_(t.id),Ge.onicecandidate=function(e){e.candidate&&a.add(e.candidate.toJSON())},e.next=8,Ge.createOffer();case 8:return r=e.sent,e.next=11,Ge.setLocalDescription(r);case 11:return c={sdp:r.sdp,type:r.type},e.next=14,t.set({offer:c});case 14:t.onSnapshot((function(e){var t=e.data();if(!Ge.currentRemoteDescription&&(null===t||void 0===t?void 0:t.answer)){var a=new RTCSessionDescription(t.answer);Ge.setRemoteDescription(a)}})),n.onSnapshot((function(e){e.docChanges().forEach((function(e){if("added"===e.type){var t=new RTCIceCandidate(e.doc.data());Ge.addIceCandidate(t)}}))})),S(!1),h(!0),O(!0);case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(f.a)(d.a.mark((function e(){var t,a,n,r,c,l,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ye.collection("calls").doc(k),e.next=3,t.get();case 3:if(e.sent.exists){e.next=8;break}return console.log("document does not exist!"),alert("Invalid call ID! Please try again."),e.abrupt("return");case 8:return console.log("why does it keep going"),a=t.collection("answerCandidates"),n=t.collection("offerCandidates"),Ge.onicecandidate=function(e){e.candidate&&a.add(e.candidate.toJSON())},e.next=14,t.get();case 14:return r=e.sent.data(),c=r.offer,e.next=18,Ge.setRemoteDescription(new RTCSessionDescription(c));case 18:return e.next=20,Ge.createAnswer();case 20:return l=e.sent,e.next=23,Ge.setLocalDescription(l);case 23:return o={type:l.type,sdp:l.sdp},e.next=26,t.update({answer:o});case 26:n.onSnapshot((function(e){e.docChanges().forEach((function(e){if(console.log(e),"added"===e.type){var t=e.doc.data();Ge.addIceCandidate(new RTCIceCandidate(t))}}))})),S(!1),h(!0),O(!0);case 30:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=!0,D=!0;return r.a.createElement("div",null,r.a.createElement("div",{className:"videos"},r.a.createElement("span",{id:"local-stream"},r.a.createElement("h3",null,"Local Stream"),r.a.createElement("video",{id:"webcamVideo",ref:e,autoPlay:!0,playsInline:!0})),r.a.createElement("span",{className:"remote-stream"},r.a.createElement("h3",null,"Remote Stream"),r.a.createElement("video",{id:"remoteVideo",ref:t,autoPlay:!0,playsInline:!0}))),r.a.createElement("div",{className:"buttons"},r.a.createElement("div",null,r.a.createElement(g.a,{id:"webcamButton",disabled:l,onClick:x},"Start webcam")),r.a.createElement("div",null,r.a.createElement("span",null,r.a.createElement(g.a,{id:"callButton",disabled:m,onClick:R},"Create Call")),r.a.createElement("span",null,r.a.createElement(g.a,{disabled:y,onClick:function(){null!=Fe&&Fe.getTracks().length>0&&(L=!L,Fe.getAudioTracks()[0].enabled=L),Fe.getTracks().forEach((function(e){"audio"===e.kind&&(e.enabled=!e.enabled)}))}},"Mute Audio")),r.a.createElement("span",null,r.a.createElement(g.a,{disabled:y,onClick:function(){null!=Fe&&Fe.getVideoTracks().length>0&&(D=!D,Fe.getVideoTracks()[0].enabled=D)}},"Mute Video"))),r.a.createElement("div",null,r.a.createElement(E.a,{id:"callInput",placeholder:"Enter Unique ID",value:k,onClick:function(){navigator.clipboard.writeText(k.textToCopy)},onChange:function(e){return _(e.target.value)}}),r.a.createElement(g.a,{id:"answerButton",disabled:v,onClick:P},"Answer")),r.a.createElement("div",null,r.a.createElement("span",null,r.a.createElement(g.a,{id:"hangupButton",disabled:y,onClick:function(){Fe.getTracks().forEach((function(e){e.stop()})),We.getTracks().forEach((function(e){e.stop()})),Ge.close(),Ge=null,e.current.srcObject=null,t.current.srcObject=null,_(""),console.log("call ended"),S(!0),s(!1)},icon:"phone"},"Hangup")))))};var tt=function(){var e={email:""},t=r.a.useState(e),a=Object(o.a)(t,2),n=a[0],c=a[1],l=r.a.useState(""),s=Object(o.a)(l,2),i=s[0],u=s[1],m=r.a.useState([]),h=Object(o.a)(m,2),p=h[0],b=h[1],v=r.a.useState(""),E=Object(o.a)(v,2),g=E[0],j=E[1],C=function(){var t=Object(f.a)(d.a.mark((function t(a){var r,l,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),r=[],!y(n)){t.next=19;break}return l=n.email,b(r),j("PENDING"),t.prev=6,t.next=9,S.auth().sendPasswordResetEmail(l);case 9:u("Please check your inbox"),j("RESOLVED"),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(6),j("RESOLVED"),b(r.concat({message:t.t0.message}));case 17:t.next=21;break;case 19:o={message:"Please fill the form"},b(r.concat(o));case 21:c(e);case 22:case"end":return t.stop()}}),t,null,[[6,13]])})));return function(e){return t.apply(this,arguments)}}(),y=function(e){return e.email},N=n.email;return r.a.createElement("div",{className:"auth"},r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"login",style:{marginTop:-70}},r.a.createElement("h2",null,r.a.createElement(O.a,{name:"unlock"})," Reset Password"),r.a.createElement("form",{size:"large",onSubmit:C},r.a.createElement("label",{style:{color:p.includes("email")?"#d72323":"white"}},"EMAIL"),r.a.createElement("input",{type:"email",name:"email",placeholder:"Email",value:N,onChange:function(e){c(Object(k.a)(Object(k.a)({},n),{},Object(L.a)({},e.target.name,e.target.value)))},className:function(e,t){return e.some((function(e){return e.message.toLowerCase().includes(t.toLowerCase())}))?"error":""}(p,"email")}),r.a.createElement("button",{disabled:"PENDING"===g,className:"PENDING"===g?"loading":"",type:"submit"},"Reset Password")),r.a.createElement("h4",null,r.a.createElement(W.b,{to:"/login"},"Return to Login? ")),i&&r.a.createElement("p",{className:"error",style:{color:"green"}},i),p.length>0&&p.map((function(e,t){return r.a.createElement("div",{className:"error",key:t},r.a.createElement("p",null,e.message))})),r.a.createElement("div",null,r.a.createElement(W.b,{to:"/register",style:{fontSize:"1.2rem"}},"New Here? Register")))))},at=Object(Ue.g)((function(){var e=Object(Ue.f)(),t=Object(i.c)(),a=Object(i.d)((function(e){return e.user.isLoading}));return Object(n.useEffect)((function(){S.auth().onAuthStateChanged((function(a){a?t(function(e){return{type:"SET/USER",payload:e}}(a)):(e.replace("/login"),t({type:"CLEAR/USER"}))}))}),[e,t]),a?r.a.createElement(He,null):r.a.createElement(Ue.c,null,r.a.createElement(Ue.a,{exact:!0,path:"/",component:Le}),r.a.createElement(Ue.a,{path:"/login",component:Ae}),r.a.createElement(Ue.a,{path:"/register",component:Me}),r.a.createElement(Ue.a,{path:"/forget-password",component:tt}),r.a.createElement(Ue.a,{exact:!0,path:"/video",component:et}))}));l.a.render(r.a.createElement(i.a,{store:Xe},r.a.createElement(W.a,null,r.a.createElement(at,null))),document.getElementById("root"))}},[[329,1,2]]]);
//# sourceMappingURL=main.c43971f5.chunk.js.map